!function e(t,s,a){function i(o,l){if(!s[o]){if(!t[o]){var c="function"==typeof require&&require;if(!l&&c)return c(o,!0);if(n)return n(o,!0);throw new Error("Cannot find module '"+o+"'")}var r=s[o]={exports:{}};t[o][0].call(r.exports,function(e){var s=t[o][1][e];return i(s?s:e)},r,r.exports,e,t,s,a)}return s[o].exports}for(var n="function"==typeof require&&require,o=0;o<a.length;o++)i(a[o]);return i}({1:[function(e,t,s){var a=React.createClass({displayName:"AppBox",getInitialState:function(){return{box:"search",politicians:[],id:"",politician:[],profile:"",currentVote:0,searching:!1,retrievingVotes:!0,votes:[],billInfo:[],sessionsList:[],session:"",sessionToggle:!1}},componentDidMount:function(){window.addEventListener("hashchange",function(){this.getAppStateFromURL(window.location.hash.substr(1))}.bind(this));var e="/initialize";this.fetchJSON(e,"politicians");var t="/sessions";this.fetchJSON(t,"sessions"),this.getAppStateFromURL(window.location.hash.substr(1))},changePolitician:function(e){e?(this.setState({politician:e,votes:[],box:"profile"}),this.getPoliticianVotes(e.id)):this.state.id&&"profile"==this.state.box?(e=this.getPolitician(),this.setState({politician:e}),this.getPoliticianVotes(e.id)):this.setState({politician:{}})},onSearchChange:function(e){this.setState({searching:!0,searchValue:e.target.value})},onBillSearchChange:function(e){this.setState({billSearching:!0,billSearchValue:e.target.value})},onSessionSelect:function(e,t){""!=e?this.setState({sessionToggle:!1,session:e.id}):this.setState({sessionToggle:!1,session:""})},onSessionSelectToggle:function(e){var t=function(e){"sessionOption"!=e.target.className&&"sessionOption"!=e.target.parentNode.className&&"select"!=e.target.className&&"sessionSelect"!=e.target.className&&this.setState({sessionToggle:!this.state.sessionToggle}),document.body.removeEventListener("click",t)}.bind(this);this.state.sessionToggle||document.body.addEventListener("click",t),this.setState({sessionToggle:!this.state.sessionToggle})},getAppStateFromURL:function(e){var t="search",s="",a=(this.state.politician,e.split("/").filter(function(e){return""!=e}));if(a.length>0){switch(t=a[0]){case"profile":break;case"bill":break;default:t="search"}a.length>=2&&(s=isNaN(a[1])?"":a[1])}this.setState({box:t,id:s,votes:[]}),this.changePolitician()},changePageTitle:function(){if(console.log("pol is"),console.log(this.state.politician),"search"==this.state.box)console.log("search is"),document.title="votes.MP - search Canadian MP voting records";else if("profile"==this.state.box&&this.state.politician.name){console.log("true is"),console.log(this.state.politician.length>0);var e=this.state.politician.name;document.title="votes.MP - "+e}},componentDidUpdate:function(e,t){console.log(t.id),t.politician!=this.state.politician&&this.changePageTitle()},getSessionVotes:function(){for(var e={},t=0,s=0;s<this.state.sessionsList.length;s++)e[this.state.sessionsList[s].id]=0;for(var s=0;s<this.state.votes.length;s++)t+=1,e[this.state.votes[s].session_id]+=1;return e.sum=t,e},getPolitician:function(e,t){if("undefined"==typeof e&&(e=this.state.politicians),"undefined"==typeof t&&(t=this.state.id),t)for(i=0;i<e.length;i++)if(e[i].id==t)return e[i];return[]},getPoliticianVotes:function(e){this.setState({retrievingVotes:!0});var t="/pol/"+e;this.fetchJSON(t,"votes")},getBillInfo:function(e,t){if(e.votequestion_id==this.state.currentVote)this.setState({currentVote:0,billInfo:[]});else{var s="/bill/"+e.votequestion_id;this.setState({currentVote:e.votequestion_id}),this.fetchJSON(s,"bill_info")}},render:function(){var e=this.filterPoliticians(),t=this.getSessionVotes(),s=this.filterVotes(),a="box "+this.state.box,i=this.state.politician;return React.createElement("div",{className:a},React.createElement(r,{box:this.state.box,politicians:e,onSearchChange:this.onSearchChange,profile:i}),React.createElement(n,{box:this.state.box,profile:i,votes:s,onBillSearchChange:this.onBillSearchChange,onSessionSelectToggle:this.onSessionSelectToggle,onSessionSelect:this.onSessionSelect,sessionsList:this.state.sessionsList,session:this.state.session,sessionToggle:this.state.sessionToggle,sessionsVotes:t,retrievingVotes:this.state.retrievingVotes,getBillInfo:this.getBillInfo,currentVote:this.state.currentVote,billInfo:this.state.billInfo}))},fetchJSON:function(e,t){var s=new XMLHttpRequest;s.open("GET",e,!0),s.onload=function(){if(s.status>=200&&s.status<400){var e=JSON.parse(s.responseText);if("politicians"==t){var a=this.getPolitician(e.results);this.setState({politicians:e.results,politician:a}),a.id&&this.getPoliticianVotes(a.id)}else"votes"==t?this.setState({votes:e.results,retrievingVotes:!1}):"sessions"==t?this.setState({sessionsList:e.results}):"bill_info"==t?this.setState({billInfo:e.results[0]}):console.log("type not politician or votes")}else console.log("server reached, but it did not give data in fetchJSON")}.bind(this),s.onerror=function(){console.log("connection problem with fetchJSON")},s.send()},filterVotes:function(){if(this.state.billSearching&&this.state.billSearchValue)var e=new RegExp(this.state.billSearchValue,"i"),t=this.state.votes.filter(function(t){return t.name_en.search(e)>-1||t.number.search(e)>-1||t.short_title_en.search(e)>-1});else var t=this.state.votes;if(this.state.session)var s=new RegExp(this.state.session,"i"),a=t.filter(function(e){return e.session_id.search(s)>-1});else var a=t;return a},filterPoliticians:function(){if(this.state.searching&&this.state.searchValue){var e=new RegExp(this.state.searchValue,"i"),t=this.state.politicians.filter(function(t){return t.name.search(e)>-1||t.party_name.search(e)>-1||t.party_slug.search(e)>-1||t.riding.search(e)>-1});return t.slice(0,25)}return this.state.politicians.slice(0,10)}}),n=React.createClass({displayName:"ProfileBox",render:function(){var e="profileBox "+this.props.box,t="close "+this.props.box;if(this.props.profile.party_slug)var s=this.props.profile.party_slug;else var s=this.props.profile.party_name;return React.createElement("div",{className:e},React.createElement("div",{className:"profileHeader"},React.createElement("a",{className:"return",href:"/#/"},React.createElement("div",{className:"icon"}),React.createElement("span",null,"return to MP search")),React.createElement("a",{className:t,href:"/#/"}),React.createElement("h2",{className:"name"},this.props.profile.name),React.createElement("span",{className:"info"},React.createElement("h3",{className:"riding"},this.props.profile.riding),React.createElement("h3",{className:"party"},s)),React.createElement(c,{onBillSearchChange:this.props.onBillSearchChange,onSessionSelectToggle:this.props.onSessionSelectToggle,onSessionSelect:this.props.onSessionSelect,sessionsList:this.props.sessionsList,sessionToggle:this.props.sessionToggle,session:this.props.session,sessionsVotes:this.props.sessionsVotes})),React.createElement(o,{votes:this.props.votes,retrievingVotes:this.props.retrievingVotes,getBillInfo:this.props.getBillInfo,currentVote:this.props.currentVote,billInfo:this.props.billInfo}))}}),o=React.createClass({displayName:"BillStack",render:function(){var e=this.props.currentVote,t=this.props.getBillInfo,s=[],a=null;if(this.props.votes.length>0){this.props.getBillText;s=this.props.votes.map(function(s,a){return React.createElement(l,{key:a,vote:s,currentVote:e,onClick:t})}.bind(this))}else if(this.props.retrievingVotes){for(var i=React.createElement("div",{className:"voteRow row empty"},React.createElement("div",{className:"main row"},React.createElement("div",{className:"col spacer left"}),React.createElement("div",{className:"col session"}),React.createElement("div",{className:"col number"}),React.createElement("div",{className:"col vote full-layout"}),React.createElement("div",{className:"col shortname"},React.createElement("span",null,"no result")),React.createElement("div",{className:"col vote mobile-only"}),React.createElement("div",{className:"col law"}),React.createElement("div",{className:"col spacer right"}))),n=0;15>n;n++)s.push(i);a=React.createElement("div",{className:"loader-container"},React.createElement("div",{className:"loader"}))}else{var o=React.createElement("div",{className:"voteRow row noresults"},React.createElement("div",{className:"main row"},React.createElement("div",{className:"col spacer"}),React.createElement("div",{className:"col"},React.createElement("span",null,"no results found")),React.createElement("div",{className:"col spacer"})));s.push(o)}return React.createElement("div",{className:"votes"},React.createElement("div",{className:"billStack"},React.createElement("div",{className:"row header"},React.createElement("div",{className:"col spacer left"}),React.createElement("div",{className:"col session"},"Session"),React.createElement("div",{className:"col number"},"Number"),React.createElement("div",{className:"col vote full-layout"},"Vote"),React.createElement("div",{className:"col shortname"},"Name"),React.createElement("div",{className:"col vote mobile-only"},"Vote"),React.createElement("div",{className:"col law"},"Law"),React.createElement("div",{className:"col spacer right"})),s,a))}}),l=React.createClass({displayName:"VoteRow",render:function(){if("Y"==this.props.vote.vote)var e="yes ",t="yes";else if("N"==this.props.vote.vote)var e="no ",t="no";else var e="",t="no vote";e+="vote col ";var s=e+"mobile-only";e+="full-layout";var a=this.props.vote.law?"passed":"failed",i="col law "+a;if(this.props.vote.short_title_en)var n=this.props.vote.short_title_en;else var n=this.props.vote.name_en;return React.createElement("div",{className:"voteRow row",key:this.props.key},React.createElement("div",{className:"main row"},React.createElement("div",{className:"col spacer left"}),React.createElement("div",{className:"col session"},React.createElement("span",{className:"label mobile-only"},"Session"),this.props.vote.session_id),React.createElement("div",{className:"col number"},React.createElement("span",{className:"label mobile-only"},"Number"),this.props.vote.number),React.createElement("div",{className:e},React.createElement("span",null,t)),React.createElement("div",{className:"col shortname"},n),React.createElement("div",{className:s},React.createElement("span",null,t)),React.createElement("div",{className:i},React.createElement("span",null,a)),React.createElement("div",{className:"col spacer right"})))}}),c=(React.createClass({displayName:"VoteInfoRow",render:function(){var e="row info";if(this.props.voteQuestionID==this.props.currentVote){e+=" current";var t="Law: "+this.props.lawText,s=React.createElement("div",{className:"col billInfo"},t)}else var s="";return React.createElement("div",{className:e},React.createElement("div",{className:"col spacer left"}),s,React.createElement("div",{className:"col spacer right"}))}}),React.createClass({displayName:"BillSearch",render:function(){if(""==this.props.session)var e="any session";else var e=this.props.session;var t=this.props.sessionsVotes,s="sessionSelect"+(this.props.sessionToggle?"":" collapsed"),a=this.props.sessionsList.map(function(e,s){var a=t[e.id];if(a){e.id+" - ("+a+")";return React.createElement("li",{onClick:this.props.onSessionSelect.bind(null,e),key:s},React.createElement("span",{className:"session"},e.id)," ",React.createElement("span",{className:"sum"},a))}}.bind(this));return React.createElement("div",{className:"billSearch"},React.createElement("form",null,React.createElement("input",{type:"search",placeholder:"Search bills by name or number...",onChange:this.props.onBillSearchChange}),React.createElement("div",{className:s},React.createElement("span",{className:"select",onClick:this.props.onSessionSelectToggle},e),React.createElement("ul",null,React.createElement("li",{className:"sessionOption",onClick:this.props.onSessionSelect.bind(null,"")},React.createElement("span",{className:"session"},"any session")," ",React.createElement("span",{className:"sum"},t.sum)),a))))}})),r=React.createClass({displayName:"SearchBox",render:function(){var e="searchBox "+this.props.box,t="searchBox-noscroll "+this.props.box;return React.createElement("div",{className:t},React.createElement("div",{className:e},React.createElement("div",{className:"topLinks"},React.createElement("a",{className:"info"},"i"),React.createElement("span",{className:"github"})),React.createElement("form",null,React.createElement("input",{type:"search",placeholder:"Search...",onChange:this.props.onSearchChange}),React.createElement("button",{type:"submit"},"Search")),React.createElement("div",{className:"searchContent"},React.createElement(h,{box:this.props.box,politicians:this.props.politicians,profile:this.props.profile}))))}}),h=React.createClass({displayName:"SearchStack",render:function(){classString="searchStack";var e=this.props.profile.id,t=[];if(this.props.politicians.length>0)t=this.props.politicians.map(function(t,s){var a="url('http://static.votes.mp/"+t.imgurl+"')",i="";if(t.id==e&&(i+="active "),t.id==e&&"profile"==this.props.box)var n="/#/";else var n="/#/profile/"+t.id;if(t.active&&(i+="current "),t.party_slug){i+=t.party_slug;var o=t.party_slug}else var o=t.party_name;return React.createElement("a",{className:i,href:n,key:s},React.createElement("div",{style:{backgroundImage:a}}),React.createElement("h3",null,t.name),React.createElement("span",{className:"party"},o))}.bind(this));else{var s=["Sir John A. McPlaceholder","Trevor Linden","Placeholder Junior, Esquire"];for(i=0;i<11;i++){var a=React.createElement("a",{className:"placeholder",href:"/#/"},React.createElement("div",null),React.createElement("h3",null,s[i%3]),React.createElement("span",{className:"party"},"VAN"));t.push(a)}}return React.createElement("div",{className:classString},React.createElement("h2",null,"Members of Parliament",React.createElement("span",{className:"leaf"})),t)}});React.render(React.createElement(a,null),document.getElementById("content"))},{}]},{},[1]);