!function e(t,a,s){function i(l,r){if(!a[l]){if(!t[l]){var o="function"==typeof require&&require;if(!r&&o)return o(l,!0);if(n)return n(l,!0);throw new Error("Cannot find module '"+l+"'")}var c=a[l]={exports:{}};t[l][0].call(c.exports,function(e){var a=t[l][1][e];return i(a?a:e)},c,c.exports,e,t,a,s)}return a[l].exports}for(var n="function"==typeof require&&require,l=0;l<s.length;l++)i(s[l]);return i}({1:[function(e,t,a){function s(e,t){""==e&&(e="/"),ga("set",{page:e,title:t}),ga("send","pageview")}tracker=ga.create("UA-67804451-1","votes.mp");var n=React.createClass({displayName:"AppBox",getInitialState:function(){return{box:"search",politicians:[],id:"",politician:{},profile:"",currentVote:0,searching:!1,retrievingVotes:!0,votes:[],billInfo:[],billText:"",sessionsList:[],session:"",sessionToggle:!1,max:10,riding:""}},componentDidMount:function(){window.addEventListener("hashchange",function(){this.getAppStateFromURL(window.location.hash.substr(1))}.bind(this));var e="/initialize";this.fetchJSON(e,"politicians");var t="/sessions";this.fetchJSON(t,"sessions"),this.getAppStateFromURL(window.location.hash.substr(1))},changePolitician:function(e){e?(this.setState({politician:e,votes:[],box:"profile"}),this.getPoliticianVotes(e.id)):!this.state.id||"profile"!=this.state.box&&"info"!=this.state.box?this.setState({politician:{}}):(e=this.getPolitician(),this.setState({politician:e}),this.getPoliticianVotes(e.id))},onSearchChange:function(e){var t=this.checkMax(),a=new RegExp("^[ABCEGHJKLMNPRSTVXYabceghjklmnprstvxy]{1}\\d{1}[A-Za-z]{1} *\\d{1}[A-Za-z]{1}\\d{1}$","i");if(a.test(e.target.value)){var s=e.target.value;s=s.replace(/\s+/g,""),s=s.toUpperCase();var i="https://represent.opennorth.ca/postcodes/"+s+"/?sets=federal-electoral-districts",n=new XMLHttpRequest;n.open("GET",i,!0),n.onload=function(){if(n.status>=200&&n.status<400){var e=JSON.parse(n.responseText),t=e.boundaries_concordance[0].name;this.setState({riding:t})}else console.log("server reached, but it did not give data in onSearchChange opennorth request")}.bind(this),n.onerror=function(){console.log("connection problem with onSearchChange opennorth request")},n.send(),this.setState({searching:!0,searchValue:e.target.value,max:t})}else this.setState({searching:!0,searchValue:e.target.value,max:t,riding:""})},onBillSearchChange:function(e){this.setState({billSearching:!0,billSearchValue:e.target.value})},onSessionSelect:function(e,t){""!=e?this.setState({sessionToggle:!1,session:e.id}):this.setState({sessionToggle:!1,session:""})},onSessionSelectToggle:function(e){var t=function(e){"sessionOption"!=e.target.className&&"sessionOption"!=e.target.parentNode.className&&"select"!=e.target.className&&"sessionSelect"!=e.target.className&&this.setState({sessionToggle:!this.state.sessionToggle}),document.body.removeEventListener("click",t)}.bind(this);this.state.sessionToggle||document.body.addEventListener("click",t),this.setState({sessionToggle:!this.state.sessionToggle})},getAppStateFromURL:function(e){var t="search",a="",i=(this.state.politician,e.split("/").filter(function(e){return""!=e}));if(i.length>0){switch(t=i[0]){case"profile":break;case"bill":break;case"info":break;default:t="search"}i.length>=2&&(a=isNaN(i[1])?"":i[1])}if("search"==t)s(e,"Search");else if("profile"==t)if(a){for(var n=a,l=0;l<this.state.politicians.length;l++)this.state.politicians[l].id==a&&(n=this.state.politicians[l].name);var r="Profile/"+n;s(e,r)}else{var r="Profile/";s(e,r)}else"info"==t?s(e,"Info"):s(e,"Unknown");this.setState({box:t,id:a,votes:[]}),this.changePolitician()},changePageTitle:function(){if("search"==this.state.box)document.title="votes.MP - search Canadian MP voting records";else if("profile"==this.state.box&&this.state.politician.name){var e=this.state.politician.name;document.title="votes.MP - "+e}},componentDidUpdate:function(e,t){t.politician!=this.state.politician&&this.changePageTitle()},getSessionVotes:function(){for(var e={},t=0,a=0;a<this.state.sessionsList.length;a++)e[this.state.sessionsList[a].id]=0;for(var a=0;a<this.state.votes.length;a++)t+=1,e[this.state.votes[a].session_id]+=1;return e.sum=t,e},getPolitician:function(e,t){if("undefined"==typeof e&&(e=this.state.politicians),"undefined"==typeof t&&(t=this.state.id),t)for(i=0;i<e.length;i++)if(e[i].id==t)return e[i];return[]},getPoliticianVotes:function(e){this.setState({retrievingVotes:!0});var t="/pol/"+e;this.fetchJSON(t,"votes")},getBillInfo:function(e,t){if(e.props.vote.votequestion_id==this.state.currentVote)this.setState({currentVote:0,billInfo:[]});else{var a="/bill/"+e.props.vote.votequestion_id;this.setState({currentVote:e.props.vote.votequestion_id,billInfo:[]}),this.fetchJSON(a,"bill_info")}},onSearchScroll:function(e,t){var a=e.getDOMNode().scrollTop,s=e.getDOMNode().scrollHeight,i=window.innerHeight;if(i+a+100>s){var n=this.filterPoliticians().length;this.state.max<n&&this.setState({max:this.state.max+10})}},checkMax:function(){var e=this.state.max,t=this.filterPoliticians().length;return t<this.state.max&&(e=t,10>e&&(e=10)),e},render:function(){var e=this.filterPoliticians().slice(0,this.state.max),t=this.getSessionVotes(),a=this.filterVotes(),s="box "+this.state.box,i=this.state.politician,n="searchBox-noscroll "+this.state.box;return React.createElement("div",{className:s},React.createElement(o,{box:this.state.box}),React.createElement("div",{className:n},React.createElement(f,{box:this.state.box,searching:this.state.searching,politicians:e,onSearchChange:this.onSearchChange,profile:i,onSearchScroll:this.onSearchScroll})),React.createElement(h,{box:this.state.box,profile:i,votes:a,onBillSearchChange:this.onBillSearchChange,onSessionSelectToggle:this.onSessionSelectToggle,onSessionSelect:this.onSessionSelect,sessionsList:this.state.sessionsList,session:this.state.session,sessionToggle:this.state.sessionToggle,sessionsVotes:t,retrievingVotes:this.state.retrievingVotes,getBillInfo:this.getBillInfo,currentVote:this.state.currentVote,billInfo:this.state.billInfo,getPolitician:this.getPolitician}),React.createElement(l,{box:this.state.box,billText:this.state.billText}))},fetchJSON:function(e,t){var a=new XMLHttpRequest;a.open("GET",e,!0),a.onload=function(){if(a.status>=200&&a.status<400){var e=JSON.parse(a.responseText);if("politicians"==t){var s=this.getPolitician(e.results);this.setState({politicians:e.results,politician:s}),s.id&&this.getPoliticianVotes(s.id)}else"votes"==t?this.setState({votes:e.results,retrievingVotes:!1}):"sessions"==t?this.setState({sessionsList:e.results}):"bill_info"==t?this.setState({billInfo:e}):"bill_text"==t?this.setState({billText:e.results[0]}):console.log("type not politician or votes")}else console.log("server reached, but it did not give data in fetchJSON")}.bind(this),a.onerror=function(){console.log("connection problem with fetchJSON")},a.send()},filterVotes:function(){if(this.state.billSearching&&this.state.billSearchValue)var e=new RegExp(this.state.billSearchValue,"i"),t=this.state.votes.filter(function(t){return t.name_en.search(e)>-1||t.number.search(e)>-1||t.short_title_en.search(e)>-1});else var t=this.state.votes;if(this.state.session)var a=new RegExp(this.state.session,"i"),s=t.filter(function(e){return e.session_id.search(a)>-1});else var s=t;return s},filterPoliticians:function(){if(this.state.searching&&this.state.searchValue){if(""!=this.state.riding){var e=new RegExp(this.state.riding,"i"),t=this.state.politicians.filter(function(t){return t.riding.search(e)>-1});return t}var e=new RegExp(this.state.searchValue,"i"),t=this.state.politicians.filter(function(t){return t.name.search(e)>-1||t.party_name.search(e)>-1||t.party_slug.search(e)>-1||t.riding.search(e)>-1||t.riding.search(e)>-1});return t}return this.state.politicians}}),l=React.createClass({displayName:"BillTextBox",render:function(){var e="billTextBox "+this.props.box;return React.createElement("div",{className:e},React.createElement("div",{className:"closeContainer"},React.createElement("a",{href:"/#/"})),React.createElement(r,{billText:this.props.billText}))}}),r=React.createClass({displayName:"BillText",prepText:function(e){return e=e.trim(),e.length>0?"<p>"+e.replace(/[\r\n]+/,"</p><p>")+"</p>":null},render:function(){var e=this.prepText(this.props.billText);return React.createElement("div",{className:"billText"},e)}}),o=React.createClass({displayName:"InfoBox",componentWillUpdate:function(e,t){"info"==e.box&&"search"!=this.props.box?this.back=!0:this.back=!1},goBack:function(e){this.back&&(e.preventDefault(),window.history.back())},render:function(){var e="infoBox "+this.props.box;return React.createElement("div",{className:e},React.createElement("div",{className:"closeContainer"},React.createElement("a",{href:"/#/",onClick:this.goBack})),React.createElement(c,null))}}),c=React.createClass({displayName:"InfoText",render:function(){return React.createElement("div",{className:"infoText"},React.createElement("h2",null,"about votes.mp"),React.createElement("p",null,"Democracies are defined by the laws that they pass, and the laws that pass are determined by the representatives we elect. In order to accurately evaluate whether our elected members of parliament are appropriately representing their electorate, the most pertinent information we have is their voting history: which bills have they voted for, which have they voted against, and which have they abstained from voting on. "),React.createElement("p",null,"While this information is made publicly available to all Canadians, we noticed that it can be slow and difficult to parse. Every bill is voted on multiple times - sometimes to pass amendments, sometimes even just to vote on whether or not it will be discussed. Unless you are able to dedicate significant time and effort into becoming well-versed on the details of each bill, attempting to analyze the votes a politician makes can be more confusing than informative."),React.createElement("p",null,"As engaged citizens who are not capable of being intimately familiar with the details and progress of every bill, what we wanted to know was this: after all the amendments and edits, did the politician vote to make the final bill a law or not? "),React.createElement("p",null,"That is what this website provides: for every member of parliament, it returns only the votes that correspond to their final vote on a bill as well as whether or not the bill was successfully passed into law."),React.createElement("p",null,"We hope that this provides an easy additional avenue for evaluating the performance of our elected members of parliament and determining their effectiveness in representing our views."),React.createElement("span",{className:"githubLink"},React.createElement("a",{href:"https://github.com/shayqn/parle"},"view project on github")),React.createElement("span",{className:"creditWhereCreditsDue"},"special thanks to ",React.createElement("a",{href:"https://openparliament.ca"},"openparliament.ca")," for providing all the data"))}}),h=React.createClass({displayName:"ProfileBox",render:function(){var e="profileBox "+this.props.box,t="close "+this.props.box;if(this.props.profile.party_slug)var a=this.props.profile.party_slug;else var a=this.props.profile.party_name;return React.createElement("div",{className:e},React.createElement("div",{className:"profileHeader"},React.createElement("a",{className:"return",href:"/#/"},React.createElement("div",{className:"icon"}),React.createElement("span",null,"return to MP search")),React.createElement("a",{className:t,href:"/#/"}),React.createElement("h2",{className:"name"},this.props.profile.name),React.createElement("span",{className:"info"},React.createElement("h3",{className:"riding"},this.props.profile.riding),React.createElement("h3",{className:"party"},a)),React.createElement(v,{onBillSearchChange:this.props.onBillSearchChange,onSessionSelectToggle:this.props.onSessionSelectToggle,onSessionSelect:this.props.onSessionSelect,sessionsList:this.props.sessionsList,sessionToggle:this.props.sessionToggle,session:this.props.session,sessionsVotes:this.props.sessionsVotes})),React.createElement(p,{votes:this.props.votes,retrievingVotes:this.props.retrievingVotes,getBillInfo:this.props.getBillInfo,currentVote:this.props.currentVote,billInfo:this.props.billInfo,getPolitician:this.props.getPolitician}))}}),p=React.createClass({displayName:"BillStack",render:function(){var e=this.props.currentVote,t=this.props.getBillInfo,a=[],s=null;if(this.props.votes.length>0){this.props.getBillText;a=this.props.votes.map(function(a,s){return React.createElement(m,{key:s,vote:a,currentVote:e,onClick:t,billInfo:this.props.billInfo,getPolitician:this.props.getPolitician})}.bind(this))}else if(this.props.retrievingVotes){for(var i=0;15>i;i++){var n=React.createElement("div",{key:i,className:"voteRow row empty"},React.createElement("div",{className:"main row"},React.createElement("div",{className:"col spacer left"}),React.createElement("div",{className:"col session"}),React.createElement("div",{className:"col number"}),React.createElement("div",{className:"col vote full-layout"}),React.createElement("div",{className:"col shortname"},React.createElement("span",null,"no result")),React.createElement("div",{className:"col vote mobile-only"}),React.createElement("div",{className:"col law"}),React.createElement("div",{className:"col dropdown"}),React.createElement("div",{className:"col spacer right"})));a.push(n)}s=React.createElement("div",{className:"loader-container"},React.createElement("div",{className:"loader"}))}else{var l=React.createElement("div",{className:"voteRow row noresults"},React.createElement("div",{className:"main row"},React.createElement("div",{className:"col spacer"}),React.createElement("div",{className:"col"},React.createElement("span",null,"no results found")),React.createElement("div",{className:"col spacer"})));a.push(l)}return React.createElement("div",{className:"votes"},React.createElement("div",{className:"billStack"},React.createElement("div",{className:"row header"},React.createElement("div",{className:"col spacer left"}),React.createElement("div",{className:"col session"},"Session"),React.createElement("div",{className:"col number"},"Number"),React.createElement("div",{className:"col vote full-layout"},"Vote"),React.createElement("div",{className:"col shortname"},"Name"),React.createElement("div",{className:"col vote mobile-only"},"Vote"),React.createElement("div",{className:"col law"},"Law"),React.createElement("div",{className:"col dropdown"}),React.createElement("div",{className:"col spacer right"})),a,s))}}),m=React.createClass({displayName:"VoteRow",render:function(){if("Y"==this.props.vote.vote)var e="yes ",t="yes";else if("N"==this.props.vote.vote)var e="no ",t="no";else var e="",t="no vote";e+="vote col ";var a=e+"mobile-only";e+="full-layout";var s=this.props.vote.law?"yes":"no",i="col law "+s;if(this.props.vote.short_title_en)var n=this.props.vote.short_title_en;else var n=this.props.vote.name_en;var l="voteRow row";return this.props.vote.votequestion_id==this.props.currentVote&&(l+=" current"),React.createElement("div",{className:l,key:this.props.key},React.createElement("div",{onClick:this.props.onClick.bind(null,this),className:"main row"},React.createElement("div",{className:"col spacer left"}),React.createElement("div",{className:"col session"},React.createElement("span",{className:"label mobile-only"},"Session"),this.props.vote.session_id),React.createElement("div",{className:"col number"},React.createElement("span",{className:"label mobile-only"},"Number"),this.props.vote.number),React.createElement("div",{className:e},React.createElement("span",null,t)),React.createElement("div",{className:"col shortname"},n),React.createElement("div",{className:a},React.createElement("span",null,t)),React.createElement("div",{className:i},React.createElement("span",null,s)),React.createElement("div",{className:"col dropdown"},React.createElement("span",null,React.createElement(d,null))),React.createElement("div",{className:"col spacer right"})),React.createElement(u,{vote:this.props.vote,currentVote:this.props.currentVote,voteQuestionID:this.props.vote.votequestion_id,billInfo:this.props.billInfo,getPolitician:this.props.getPolitician}))}}),u=React.createClass({displayName:"VoteInfoRow",render:function(){var e="row info",t=this.props.getPolitician,a=null;if(this.props.voteQuestionID==this.props.currentVote){e+=" current";var s="Law: "+this.props.lawText;React.createElement("div",{className:"col billInfo"},s);if(void 0!=this.props.billInfo.votes){var i=[],n=0,l=React.createElement("div",{key:0,className:"partyVote header",key:n},React.createElement("div",{className:"name"},"Party"),React.createElement("div",{className:"yes"},"Y"),React.createElement("div",{className:"no"},"N"),React.createElement("div",{className:"abstain"},"A"));i.push(l),yesCount=0,noCount=0,abstainCount=0;for(var r in this.props.billInfo.votes){n++;var o=r,c=this.props.billInfo.votes[r].Y,h=this.props.billInfo.votes[r].N,p=this.props.billInfo.votes[r].A,m="no",u="yes",v="abstain",f="partyVote";f+=c>p&&c>h?" yes":h>p&&h>c?" no":p>c&&p>h?" abstain":c==h?" tie yn":c==p?" tie ya":h==p?" tie na":" tie",yesCount+=c,noCount+=h,abstainCount+=p;var l=React.createElement("div",{className:f,key:n},React.createElement("div",{className:"name"},o),React.createElement("div",{className:u},React.createElement("span",null,c)),React.createElement("div",{className:m},React.createElement("span",null,h)),React.createElement("div",{className:v},React.createElement("span",null,p)));i.push(l)}var g="partyVote total ";g+=yesCount>noCount?yesCount>abstainCount?" yes":" abstain":noCount>abstainCount?" no":" abstain";var R=React.createElement("div",{className:"partyVote total",key:"t"},React.createElement("div",{className:"name"},"Total"),React.createElement("div",{className:"yes"},React.createElement("span",null,yesCount)),React.createElement("div",{className:"no"},React.createElement("span",null,noCount)),React.createElement("div",{className:"abstain"},React.createElement("span",null,abstainCount)));if(i.push(R),this.props.billInfo.sponsor){var E=t(void 0,this.props.billInfo.sponsor),b="url('/static/headshots/"+E.imgurl+"')",N="sponsorProfile ",y="/#/profile/"+E.id;if(E.party_slug){N+=E.party_slug;var o=E.party_slug}else var o=E.party_name;a=React.createElement("div",{className:"col sponsor"},React.createElement("h4",null,"Bill Sponsor"),React.createElement("a",{className:N,href:y},React.createElement("div",{style:{backgroundImage:b}}),React.createElement("h3",null,E.name),React.createElement("span",{className:"riding"},E.riding),React.createElement("span",{className:"party"},o)))}else a=null}else var i=""}else var i="";var S="//openparliament.ca/bills/"+this.props.vote.session_id+"/"+this.props.vote.number+"/";sessionNumbers=this.props.vote.session_id.split("-");var x="//www.parl.gc.ca/LEGISInfo/LAAG.aspx?language=E&Parl="+sessionNumbers[0]+"&Ses="+sessionNumbers[1];return React.createElement("div",{className:e},React.createElement("div",{className:"col spacer left"}),a,React.createElement("div",{className:"col partyVotes"},React.createElement("h4",null,"Party Votes"),React.createElement("div",{className:"partyVotesTable"},i)),React.createElement("div",{className:"col moreBillInfo"},React.createElement("h4",null,"More Information"),React.createElement("a",{href:S},"view bill on openparliament.ca ",React.createElement(d,null)),React.createElement("a",{href:x},"view session on parl.gc.ca ",React.createElement(d,null))),React.createElement("div",{className:"col spacer right"}))}}),d=React.createClass({displayName:"ArrowIcon",render:function(){return React.createElement("svg",{version:"1.1",x:"0px",y:"0px",viewBox:"0 0 400 400"},React.createElement("path",{d:"M163.5,334.5l-47.1-47.1l87.5-87.5l-87.5-87.5l47.1-47.1L298,200L163.5,334.5z"}))}}),v=React.createClass({displayName:"BillSearch",render:function(){if(""==this.props.session)var e="any session";else var e=this.props.session;var t=this.props.sessionsVotes,a="sessionSelect"+(this.props.sessionToggle?"":" collapsed"),s=this.props.sessionsList.map(function(e,a){var s=t[e.id];if(s){e.id+" - ("+s+")";return React.createElement("li",{onClick:this.props.onSessionSelect.bind(null,e),key:a},React.createElement("span",{className:"session"},e.id)," ",React.createElement("span",{className:"sum"},s))}}.bind(this));return React.createElement("div",{className:"billSearch"},React.createElement("form",null,React.createElement("input",{type:"search",placeholder:"Search bills by name or number...",onChange:this.props.onBillSearchChange}),React.createElement("div",{className:a},React.createElement("span",{className:"select",onClick:this.props.onSessionSelectToggle},e),React.createElement("ul",null,React.createElement("li",{className:"sessionOption",onClick:this.props.onSessionSelect.bind(null,"")},React.createElement("span",{className:"session"},"any session")," ",React.createElement("span",{className:"sum"},t.sum)),s))))}}),f=React.createClass({displayName:"SearchBox",render:function(){var e="searchBox "+this.props.box;return React.createElement("div",{className:e,onScroll:this.props.onSearchScroll.bind(null,this)},React.createElement("div",{className:"topLinks"},React.createElement("a",{href:"/#/info",className:"info"}),React.createElement("a",{href:"https://github.com/shayqn/parle",className:"github"})),React.createElement("form",null,React.createElement("input",{type:"search",placeholder:"Search...",onChange:this.props.onSearchChange}),React.createElement("button",{type:"submit"},"Search"),React.createElement("span",null,"by name, riding, or postal code")),React.createElement("div",{className:"searchContent"},React.createElement(g,{box:this.props.box,politicians:this.props.politicians,profile:this.props.profile,searching:this.props.searching})))}}),g=React.createClass({displayName:"SearchStack",render:function(){classString="searchStack";var e=this.props.profile.id,t=[];if(this.props.politicians.length>0)t=this.props.politicians.map(function(t,a){var s="url('/static/headshots/"+t.imgurl+"')",i="";if(t.id==e&&(i+="active "),t.id==e&&"profile"==this.props.box)var n="/#/";else var n="/#/profile/"+t.id;if(t.active&&(i+="current "),t.party_slug){i+=t.party_slug;var l=t.party_slug}else var l=t.party_name;return t.name.length>19&&(i+=t.name.length>22?" reduce-large":" reduce-medium"),React.createElement("a",{className:i,href:n,key:a},React.createElement("div",{style:{backgroundImage:s}}),React.createElement("h3",null,t.name),React.createElement("span",{className:"party"},l))}.bind(this));else if(this.props.searching){var a=React.createElement("a",null,React.createElement("h3",null,"NO RESULTS"));t.push(a)}else{var s=["John A. Placeholder","John Fakenbaker","Pierre Tempdeau"];for(i=0;i<11;i++){var n=React.createElement("a",{key:i,className:"placeholder",href:"/#/"},React.createElement("div",null),React.createElement("h3",null,s[i%3]),React.createElement("span",{className:"party"},"VAN"));t.push(n)}}return React.createElement("div",{className:classString},React.createElement("h2",null,"Members of Parliament",React.createElement("span",{className:"leaf"})),t)}});React.render(React.createElement(n,null),document.getElementById("content"))},{}]},{},[1]);